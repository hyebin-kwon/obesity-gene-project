# README: ë¹„ë§Œ ìœ ì „ì ê¸°ë°˜ ì²´ì¤‘ ê°ì†Œ ì˜ˆì¸¡ í”„ë¡œì íŠ¸

## <í”„ë¡œì íŠ¸ ê°œìš”>

- **ëª©í‘œ**: ë¹„ë§Œ ê´€ë ¨ ìœ ì „ì ë°œí˜„ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì²´ì¤‘, BMI, ì²´ì§€ë°©ë¥ , ìˆœìˆ˜ì§€ë°©ëŸ‰ ë“± ì²´ì„±ë¶„ ë³€í™”ëŸ‰ì„ ì˜ˆì¸¡í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ ê°œë°œ
- **ê¸°ë°˜ ë…¼ë¬¸**: *Adipose tissue gene expression is differentially regulated with different rates of weight loss in overweight and obese humans* (2017)
- **ë°ì´í„°ì…‹ êµ¬ì„±**: GEO ë§ˆì´í¬ë¡œì–´ë ˆì´ ë°œí˜„ ë°ì´í„° + ë©”íƒ€ë°ì´í„° + ì²´ì„±ë¶„ ë³€í™”ëŸ‰ (3ì‹œì )

## <ì‚¬ìš©í•œ ê¸°ìˆ  ìŠ¤íƒ ë° ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬>

- **ë°ì´í„° ì²˜ë¦¬**: `pandas`, `numpy`, `GEOparse`, `sqlite3`
- **ì‹œê°í™”**: `matplotlib`, `seaborn`, `plotly`
- **ë¨¸ì‹ ëŸ¬ë‹**: `scikit-learn`, `xgboost`, `lightgbm`, `catboost`, `optuna`, `shap`
- **DB ê´€ë¦¬**: SQLite (DB ìƒì„± ë° ì™¸ë˜í‚¤ êµ¬ì„±)
- **í†µê³„ë¶„ì„**: í”¼ì–´ìŠ¨ ìƒê´€ê³„ìˆ˜, Z-score í‘œì¤€í™”
- **ì°¨ì› ì¶•ì†Œ**: PCA
- **ë°ì´í„° ì¦ê°•**: `KMeans` ê¸°ë°˜ êµ°ì§‘ + ë…¸ì´ì¦ˆ ì¶”ê°€

## <íŒŒì¼ë³„ ìš”ì•½>

### 02\_data\_download.ipynb

- ë…¼ë¬¸ ê¸°ë°˜ìœ¼ë¡œ GEO ë°ì´í„°ì…‹ ì„ ì •
- GEOparseë¥¼ í™œìš©í•´ platform ìœ ì „ì ì •ë³´, ê° ì‹¤í—˜ìì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°, expression íŒŒì¼ ë‹¤ìš´ë¡œë“œ

### 03\_sqlite\_db\_build.ipynb ìš”ì•½

#### <ëª©ì >

- GEOì—ì„œ ìˆ˜ì§‘í•œ ìœ ì „ì ë°œí˜„ ë°ì´í„°, í”¼í—˜ì ë©”íƒ€ë°ì´í„°, ì²´ì„±ë¶„ ë³€í™”ë¥¼ ì •ê·œí™”í•˜ì—¬ SQLite ë°ì´í„°ë² ì´ìŠ¤ë¡œ í†µí•©
- ì‹œì  ê°„ ë³€í™”ëŸ‰ ê³„ì‚°ê³¼ ì¡°ì¸ì„ ì‰½ê²Œ í•˜ê¸° ìœ„í•œ êµ¬ì¡° ì„¤ê³„

#### <ì£¼ìš” í…Œì´ë¸” êµ¬ì„±>

| í…Œì´ë¸”ëª…                 | ì„¤ëª…                                               |
| -------------------- | ------------------------------------------------ |
| metadata             | ì‹¤í—˜ ëŒ€ìƒì ì •ë³´ (ì„±ë³„, ë‚˜ì´, í‚¤, ì¹˜ë£Œ ê·¸ë£¹, ì¸¡ì • ì‹œì  ë“±)            |
| expression           | ì›ë³¸ ìœ ì „ì ë°œí˜„ê°’ (wide format)                         |
| expression\_long     | meltëœ gene expression â†’ ì‹œê³„ì—´ ë¶„ì„ì— ìœ ë¦¬               |
| expression\_change   | ìœ ì „ì ë°œí˜„ëŸ‰ ë³€í™”ëŸ‰ ê³„ì‚° (exp\_C\_A, exp\_C\_B, exp\_B\_A) |
| weight\_bmi\_changes | ì²´ì„±ë¶„ ë³€í™”ëŸ‰ ë° ì£¼ë‹¹ ë³€í™”ëŸ‰(rate) ê³„ì‚°                        |
| platform             | ë§ˆì´í¬ë¡œì–´ë ˆì´ í”Œë«í¼ìƒì˜ ìœ ì „ì ì •ë³´                             |

#### <ì‹œì  êµ¬ë¶„ ë° ë³€í™”ëŸ‰ ê³„ì‚°>

- `time_point`: at\_study\_start, end\_of\_diet, end\_of\_stable â†’ ì‹œì  A, B, Cë¡œ ì •ì˜
- treatmentì— ë”°ë¼ ê¸°ê°„ ìƒì´: LCD 12ì£¼, VLCD 5ì£¼ â†’ ì£¼ë‹¹ ë³€í™”ëŸ‰ ê³„ì‚° í¬í•¨

#### <í…Œì´ë¸” ê°„ ì—°ê²° ë°©ì‹>

- `subject_id`, `gene_id`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í…Œì´ë¸” ê°„ ì¡°ì¸ ê°€ëŠ¥ -è¡ç”Ÿ í…Œì´ë¸”(`expression_change`, `weight_bmi_changes`)ì€ ì‹œì  ê°„ ì°¨ì´ ë¶„ì„ìš©

#### <ìš”ì•½ ì •ë¦¬>

- ì‹¤í—˜ ë””ìì¸(ê¸°ê°„ ì°¨ì´)ì„ ë°˜ì˜í•œ rate per week ê³„ì‚°ìœ¼ë¡œ ì •ë°€í•œ ì˜ˆì¸¡ êµ¬ì¡° êµ¬ì„±

### 04\_eda\_visualization.ipynb

- ìœ ì „ì vs ê²°ê³¼ì§€í‘œ ê°„ í”¼ì–´ìŠ¨ ìƒê´€ê³„ìˆ˜ ë¶„ì„
- ì´ˆê¸°ì—” ìˆœìˆ˜ì§€ë°©ëŸ‰(pure\_fat)ì´ ê°€ì¥ ì˜ˆì¸¡ë ¥(RÂ²) ë†’ìŒ â†’ ì´í›„ ê²°ê³¼ ë‹¬ë¼ì§

#### <ëª¨ë¸ ì˜ˆì¸¡ ì„±ëŠ¥ ë¹„êµ>

- RandomForestRegressor: RÂ² = 0.79
- XGBRegressor: RÂ² = 0.93
- XGB+KFold: RÂ² = 0.41 (ê³¼ì í•© ì¶”ì •)

### <SHAP ë¶„ì„ (ë¹„ë§Œ ìœ ì „ì 12ê°œ)>

- **LEP, NEGR1, ADIPOQ**ê°€ ìˆœìˆ˜ì§€ë°©ëŸ‰ ì˜ˆì¸¡ì— ìœ ì˜ë¯¸í•œ ê¸°ì—¬
- LEP: ì²´ì§€ë°©ëŸ‰ ì¡°ì ˆ í˜¸ë¥´ëª¬ / NEGR1: ì‹ ê²½ ì„±ì¥ ì¡°ì ˆ / ADIPOQ: í•­ì—¼ ë° ì¸ìŠë¦° ë¯¼ê°ë„ ê°œì„ 
- ë°˜ë©´ **FTO, TMEM18, PPARG, LEPR**ëŠ” SHAP ê°’ ë‚®ìŒ â†’ ì˜í–¥ë ¥ ì œí•œì 

### 05\_SHAP\_meta\_gene\_impact.ipynb

- ë©”íƒ€ë°ì´í„°ê°€ ìœ ì „ì ë°œí˜„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ì˜ˆì¸¡ (MultiOutputRegressor ê¸°ë°˜)

#### <SHAP ê¸°ë°˜ ìƒí˜¸ì‘ìš© ì¸ì‚¬ì´íŠ¸>

1. **Feature-wise í‰ê·  SHAP**: `height_cm`, `base_pure_fat_kg`, `base_body_fat_pct`, `base_weight_kg` ë“± ì¤‘ìš” / `sex_male` ì˜í–¥ ê±°ì˜ ì—†ìŒ
2. **Z-score SHAP (feature ê¸°ì¤€)**: `MC4R`, `LEP`, `BDNF`ê°€ íŠ¹ì • featureì— ë¯¼ê°
3. **Z-score SHAP (gene ê¸°ì¤€)**: `PPARG`, `UCP2`, `GNPDA2`, `ADIPOQ`ê°€ ë‹¤ì–‘í•œ í”¼ì²˜ì—ì„œ ë°˜ì‘

#### <ìš”ì•½>

- ë¯¼ê° ìœ ì „ì: `MC4R`, `LEP`, `BDNF`, `PPARG`
- ì£¼ìš” ë©”íƒ€ í”¼ì²˜: `í‚¤`, `ê¸°ì´ˆ ìˆœìˆ˜ì§€ë°©ëŸ‰`, `BMI`, `ì²´ì§€ë°©ë¥ `

### 06\_SHAP\_meta\_results\_impact.ipynb

- ë©”íƒ€ë°ì´í„° â†’ ê²°ê³¼ì§€í‘œ ì˜ˆì¸¡ì— ëŒ€í•œ SHAP ë¶„ì„

#### <ì£¼ìš” ì¸ì‚¬ì´íŠ¸>

1. `base_weight_kg`, `base_body_fat_pct`ê°€ ì˜ˆì¸¡ì— ê°€ì¥ í° ê¸°ì—¬
2. ê²°ê³¼ì§€í‘œë³„ ë¯¼ê° í”¼ì²˜:
   - ì²´ì¤‘(weight): `base_weight_kg`, `base_bmi_kg_m2`
   - BMI: `base_bmi_kg_m2`, `base_body_fat_pct`
   - ì²´ì§€ë°©ë¥ : `base_body_fat_pct`
   - ìˆœìˆ˜ì§€ë°©ëŸ‰: `base_weight_kg`, `base_pure_fat_kg`

#### <ìš”ì•½>

- ì„±ë³„ ì˜í–¥ë„ëŠ” ë¯¸ë¯¸
- ì˜ˆì¸¡ ëŒ€ìƒì— ë”°ë¼ ë¯¼ê°í•œ featureê°€ ë‹¤ë¥´ë¯€ë¡œ feature ì„ íƒ ì¤‘ìš”

### 07\_SHAP\_gene\_results\_impact.ipynb

- ìœ ì „ì ë°œí˜„ëŸ‰ìœ¼ë¡œ ì²´ì„±ë¶„ ë³€í™”ëŸ‰ ì˜ˆì¸¡
- SHAP > 0 ìœ ì „ì ìˆ˜/ë¹„ìœ¨ ê¸°ë°˜ í•„í„°ë§
- ê¸°ì¡´ ë¹„ë§Œ ìœ ì „ì 12ê°œëŠ” ì˜í–¥ ì ìŒ â†’ ìƒìœ„ SHAP ìœ ì „ì ì¤‘ ê¸°ëŠ¥ ë¶ˆëª…í™•í•œ ìœ ì „ì ë°œê²¬ ì‹œ ì—°êµ¬ ê°€ì¹˜ ìˆìŒ

#### ì‹¤í—˜ ì¡°ê±´ ë¹„êµ

- Aì•ˆ (fat\_mass ê¸°ì¤€ ìƒìœ„ 138ê°œ ìœ ì „ì): RÂ² = 0.39
- Bì•ˆ (4ê°œ ì§€í‘œ í•©ì§‘í•© 475ê°œ ìœ ì „ì): RÂ² = 0.33 â†’ **Aì•ˆ ì±„íƒ**

### 08\_ìµœì¢… ëª¨ë¸ (CatBoost + Optuna)

- **ì „ì²˜ë¦¬**: X, y êµ¬ì„±ì— ë³µì¡í•œ ì „ì²˜ë¦¬ í•„ìš”
- **íŒŒì´í”„ë¼ì¸**:
  - KMeans + Noise ë°ì´í„° ì¦ê°• (3ë°°)
  - StandardScaler â†’ PCA ì°¨ì› ì¶•ì†Œ
  - Optuna í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ì ìš©

#### <Best ì„±ëŠ¥>

- Best RÂ²: **0.9703**
- Best Params:
  ```
  {'depth': 4, 'learning_rate': 0.0419998814673207, 'l2_leaf_reg': 1.4499985542901122}
  ```

#### <Test RÂ² (ì§€í‘œë³„ ì„±ëŠ¥)>

| ê²°ê³¼ì§€í‘œ             | RÂ²     |
| ---------------- | ------ |
| weight\_kg\_C\_A | 0.9803 |
| weight\_kg\_C\_B | 0.9668 |
| weight\_kg\_B\_A | 0.9800 |
| bmi\_C\_A        | 0.9706 |
| bmi\_C\_B        | 0.9496 |
| bmi\_B\_A        | 0.9859 |
| fat\_C\_A        | 0.9672 |
| fat\_C\_B        | 0.9811 |
| fat\_B\_A        | 0.9540 |
| pure\_fat\_C\_A  | 0.9667 |
| pure\_fat\_C\_B  | 0.9764 |
| pure\_fat\_B\_A  | 0.9650 |

â†’ **ì „ì²´ í‰ê·  RÂ²: 0.9703** â†’ ë§¤ìš° ë†’ì€ ì˜ˆì¸¡ ì„±ëŠ¥ ë‹¬ì„±

---

## ì™¸ë¶€ ëŒ€ìš©ëŸ‰ íŒŒì¼ ë‹¤ìš´ë¡œë“œ

ì´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ëœ `.db`, `.csv`, `.npy` ë“±ì˜ ëŒ€ìš©ëŸ‰ íŒŒì¼ì€ GitHub ìš©ëŸ‰ ì œí•œìœ¼ë¡œ ì¸í•´  
ì•„ë˜ Google Drive ë§í¬ë¥¼ í†µí•´ ë³„ë„ë¡œ ì œê³µ

ğŸ‘‰ [Download external_data.zip (Google Drive)][([https://drive.google.com/file/d/1a2b3cXYZ/view?usp=sharing](https://drive.google.com/file/d/1_Iw_u2hCMIvgNgdS16fDgWrFgiXS5X2A/view?usp=sharing))](https://drive.google.com/file/d/1_Iw_u2hCMIvgNgdS16fDgWrFgiXS5X2A/view?usp=sharing)

## ì°¸ê³  ë¬¸í—Œ

- RG Vink et al. *International Journal of Obesity*, 2017. "Adipose tissue gene expression is differentially regulated with different rates of weight loss..."


